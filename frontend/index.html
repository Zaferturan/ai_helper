<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Yardımcı - Nilüfer Belediyesi</title>
    <link rel="stylesheet" href="style.css?v=20250914-04">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <p>İşlem yapılıyor...</p>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="login-screen" class="screen">
        <div class="main-wrapper">
            <div class="login-card">
                <div class="login-header">
                    <img src="logo.png" alt="Nilüfer Belediyesi" class="logo">
                    <h1>AI Yardımcı</h1>
                    <p>Nilüfer Belediyesi Yapay Zeka Asistanı</p>
                </div>
                
                <div class="login-content">
                    <h2>E-posta ile Giriş</h2>
                    <p class="instruction">E-posta adresinizi girin, size giriş kodu gönderelim.</p>
                    
                    <div class="form-group">
                        <input type="email" id="email-input" placeholder="ornek@nilufer.bel.tr" required>
                    </div>
                    
                    <button id="send-btn" class="btn btn-primary">
                        <span id="send-text">📧 Bağlantı ve Kod Gönder</span>
                        <span id="send-spinner" class="spinner hidden">📧 Gönderiliyor...</span>
                    </button>
                    
                    <div id="login-error" class="error-message hidden"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Code Verification Screen -->
    <div id="code-screen" class="screen hidden">
        <div class="main-wrapper">
            <div class="login-card">
                <div class="login-header">
                    <h1>Kod Doğrulama</h1>
                    <p>E-postanıza gönderilen kodu girin</p>
                    <div class="email-info" style="display: none; color: #666; font-size: 14px; margin-top: 10px;"></div>
                </div>
                
                <div class="login-content">
                    <div class="form-group">
                        <input type="text" id="code-input" placeholder="6 haneli kod" maxlength="6" required>
                    </div>
                    
                    <button id="verify-btn" class="btn btn-primary">
                        <span id="verify-text">✅ Kodu Doğrula</span>
                        <span id="verify-spinner" class="spinner hidden">✅ Doğrulanıyor...</span>
                    </button>
                    
                    <div id="code-error" class="error-message hidden"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Completion Screen -->
    <div id="profile-screen" class="screen hidden">
        <div class="main-wrapper">
            <div class="profile-card">
                <h2>👤 Profil Bilgilerinizi Tamamlayın</h2>
                <p class="instruction">Devam etmek için lütfen profil bilgilerinizi tamamlayın.</p>
                
                <div class="form-group">
                    <label for="profile-name">Ad Soyad</label>
                    <input type="text" id="profile-name" placeholder="Adınız Soyadınız" required>
                </div>
                
                <div class="form-group">
                    <label for="profile-department">Birim/Müdürlük</label>
                    <select id="profile-department" required>
                        <option value="">Birim seçiniz</option>
                        <option value="Başkanlık">Başkanlık</option>
                        <option value="Genel Sekreterlik">Genel Sekreterlik</option>
                        <option value="Mali Hizmetler Müdürlüğü">Mali Hizmetler Müdürlüğü</option>
                        <option value="İnsan Kaynakları ve Eğitim Müdürlüğü">İnsan Kaynakları ve Eğitim Müdürlüğü</option>
                        <option value="Bilgi İşlem Müdürlüğü">Bilgi İşlem Müdürlüğü</option>
                        <option value="Hukuk Müdürlüğü">Hukuk Müdürlüğü</option>
                        <option value="Strateji Geliştirme Müdürlüğü">Strateji Geliştirme Müdürlüğü</option>
                        <option value="Dış İlişkiler Müdürlüğü">Dış İlişkiler Müdürlüğü</option>
                        <option value="Kültür ve Sosyal İşler Müdürlüğü">Kültür ve Sosyal İşler Müdürlüğü</option>
                        <option value="Basın Yayın ve Halkla İlişkiler Müdürlüğü">Basın Yayın ve Halkla İlişkiler Müdürlüğü</option>
                        <option value="İmar ve Şehircilik Müdürlüğü">İmar ve Şehircilik Müdürlüğü</option>
                        <option value="Fen İşleri Müdürlüğü">Fen İşleri Müdürlüğü</option>
                        <option value="Çevre Koruma ve Kontrol Müdürlüğü">Çevre Koruma ve Kontrol Müdürlüğü</option>
                        <option value="Park ve Bahçeler Müdürlüğü">Park ve Bahçeler Müdürlüğü</option>
                        <option value="Ulaşım Hizmetleri Müdürlüğü">Ulaşım Hizmetleri Müdürlüğü</option>
                        <option value="İtfaiye Müdürlüğü">İtfaiye Müdürlüğü</option>
                        <option value="Zabıta Müdürlüğü">Zabıta Müdürlüğü</option>
                        <option value="Temizlik İşleri Müdürlüğü">Temizlik İşleri Müdürlüğü</option>
                        <option value="Su ve Kanalizasyon Müdürlüğü">Su ve Kanalizasyon Müdürlüğü</option>
                        <option value="Sosyal Yardım İşleri Müdürlüğü">Sosyal Yardım İşleri Müdürlüğü</option>
                        <option value="Kadın ve Aile Hizmetleri Müdürlüğü">Kadın ve Aile Hizmetleri Müdürlüğü</option>
                        <option value="Gençlik ve Spor Hizmetleri Müdürlüğü">Gençlik ve Spor Hizmetleri Müdürlüğü</option>
                        <option value="Kütüphane Müdürlüğü">Kütüphane Müdürlüğü</option>
                        <option value="Müze Müdürlüğü">Müze Müdürlüğü</option>
                        <option value="Tiyatro Müdürlüğü">Tiyatro Müdürlüğü</option>
                        <option value="Konservatuvar Müdürlüğü">Konservatuvar Müdürlüğü</option>
                        <option value="Diğer">Diğer</option>
                    </select>
                </div>
                
                <button id="complete-profile-btn" class="btn btn-primary">
                    <span id="profile-text">✅ Profili Tamamla</span>
                    <div id="profile-spinner" class="spinner hidden">⏳</div>
                </button>
                <div id="profile-error" class="error-message hidden"></div>
            </div>
        </div>
    </div>

    <!-- Main Application Screen -->
    <div id="main-screen" class="screen main-screen hidden">
        <div class="main-wrapper">
            <!-- Ana Banner -->
            <div class="main-banner">
                <div class="banner-content">
                    <div class="logo-container">
                        <img src="logo.png" alt="Nilüfer Belediyesi" class="logo">
                    </div>
                    <div class="banner-text">
                        <h1>AI Yardımcı</h1>
                        <p>Nilüfer Belediyesi - Yapay Zeka Destekli Yanıt Üretim Sistemi</p>
                    </div>
                </div>
            </div>

            <!-- Kullanıcı Bilgi Çubuğu -->
            <div class="user-info-bar">
                <div class="user-info">
                    <span id="user-profile">👤 Kullanıcı</span>
                </div>
                <button id="logout-btn" class="btn btn-secondary">🚪 Çıkış Yap</button>
            </div>

            <!-- Admin İstatistikler Akordeonu -->
            <div id="admin-panel" class="admin-panel hidden">
                <div class="accordion-header" onclick="toggleAdminPanel()">
                    <h3>📊 İstatistikler</h3>
                    <span class="accordion-icon">▼</span>
                </div>
                <div class="accordion-content">
                    <div id="admin-stats-content">
                        <div class="loading">İstatistikler yükleniyor...</div>
                    </div>
                    <button id="refresh-admin-btn" class="btn btn-secondary">🔄 Yenile</button>
                </div>
            </div>

            <!-- Ana Uygulama Alanı -->
            <div class="main-app-area">
                <!-- İki sütunlu layout -->
                <div class="app-layout">
                    <!-- Sol sütun - Giriş ve ayarlar -->
                    <div class="left-column">
                        <!-- Gelen İstek/Öneri -->
                        <div class="request-section">
                            <h3></h3>
                            <label class="section-label">Gelen istek/öneri metnini buraya yapıştırın:</label>
                            <textarea id="original-text" placeholder="İstek/öneri metnini buraya yapıştırın...">Bursa Nilüfer'de bir dükkanım var ve yönetim planından tahsisli otoparkımda bulunan dubaları, belediye ekipleri mafyavari şekilde tahsisli alanımdan alıp götürebiliyor. Geri aradığımda ise belediye zabıtası, görevliyi mahkemeye vermemi söylüyor. Bu nasıl bir hizmet anlayışı? Benim tahsisli alanımdan eşyamı alıyorsunuz, buna ne denir? Herkes biliyordur. Bir yeri koruduğunu zannedip başka bir yeri mağdur etmek mi belediyecilik?</textarea>
                        </div>

                        <!-- Hazırladığınız Cevap -->
                        <div class="request-section">
                            <h3></h3>
                            <label class="section-label">Hazırladığınız cevap taslağını buraya yazın:</label>
                            <textarea id="custom-input" placeholder="Cevap taslağınızı buraya yazın...">Orası size tahsis edilmiş bir yer değil. Nilüfer halkının ortak kullanım alanı. Kaldırımlar da öyle.</textarea>
                        </div>

                        <!-- Yanıt Ayarları Akordeonu -->
                        <div id="response-settings" class="settings-accordion">
                            <div class="accordion-header" onclick="toggleSettings()">
                                <h3>⚙️ Yanıt Ayarları</h3>
                                <span class="accordion-icon">▼</span>
                            </div>
                            <div class="accordion-content">
                                <div class="settings-grid">
                                    <div class="setting-item">
                                        <label for="model-select">Model</label>
                                        <select id="model-select">
                                            <option value="gemini-2.5-flash">gemini-2.5-flash</option>
                                            <option value="gemini-1.5-flash-002">gemini-1.5-flash-002</option>
                                            <option value="gemini-2.0-flash-001">gemini-2.0-flash-001</option>
                                            <option value="gpt-oss:latest">gpt-oss:latest</option>
                                        </select>
                                    </div>
                                    <div class="setting-item">
                                        <label for="temperature">Yaratıcılık (Temperature)</label>
                                        <input type="range" id="temperature" min="0.1" max="2.0" step="0.1" value="0.7">
                                        <span id="temperature-value">0.7</span>
                                    </div>
                                    <div class="setting-item">
                                        <label for="max-tokens">Maksimum Token Sayısı</label>
                                        <input type="range" id="max-tokens" min="100" max="4000" step="100" value="4000">
                                        <span id="max-tokens-value">4000</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Yanıt Üret Butonu -->
                        <button id="generate-btn" class="btn btn-primary">🚀 Yanıt Üret</button>
                    </div>

                    <!-- Sağ sütun - Sonuçlar -->
                    <div class="right-column">
                        <!-- Son Üretilen Yanıt -->
                        <div class="response-section">
                            <label>Son Üretilen Yanıt</label>
                            <div id="response-area" class="response-area">
                                <div id="main-response" class="response-content">Henüz yanıt üretilmedi...</div>
                            </div>
                            <div class="response-actions">
                                <button id="main-copy-btn" class="btn btn-success">📋 Seç ve Kopyala</button>
                                <button id="new-request-btn" class="btn btn-secondary">🆕 Yeni İstek Öneri Cevapla</button>
                            </div>
                        </div>

                        <!-- Önceki Yanıtlar -->
                        <div class="previous-responses">
                            <div id="previous-responses" class="previous-list">
                                <div class="no-responses">Henüz önceki yanıt yok</div>
                            </div>
                            
                            <!-- Önceki yanıtlar için accordion'lar (Gradio app.py'den) -->
                            <div class="previous-accordions">
                                <div id="prev-accordion-1" class="previous-accordion hidden">
                                    <div class="accordion-header" onclick="toggleAccordion('prev-content-1')">
                                        <span class="accordion-title">📄 Yanıt #1</span>
                                        <span class="accordion-icon">▼</span>
                                    </div>
                                    <div id="prev-content-1" class="accordion-content hidden">
                                        <div id="prev-text-1" class="response-textarea"></div>
                                        <button id="prev-copy-btn-1" class="btn btn-secondary btn-sm">📋 Seç ve Kopyala #1</button>
                                    </div>
                                </div>
                                
                                <div id="prev-accordion-2" class="previous-accordion hidden">
                                    <div class="accordion-header" onclick="toggleAccordion('prev-content-2')">
                                        <span class="accordion-title">📄 Yanıt #2</span>
                                        <span class="accordion-icon">▼</span>
                                    </div>
                                    <div id="prev-content-2" class="accordion-content hidden">
                                        <div id="prev-text-2" class="response-textarea"></div>
                                        <button id="prev-copy-btn-2" class="btn btn-secondary btn-sm">📋 Seç ve Kopyala #2</button>
                                    </div>
                                </div>
                                
                                <div id="prev-accordion-3" class="previous-accordion hidden">
                                    <div class="accordion-header" onclick="toggleAccordion('prev-content-3')">
                                        <span class="accordion-title">📄 Yanıt #3</span>
                                        <span class="accordion-icon">▼</span>
                                    </div>
                                    <div id="prev-content-3" class="accordion-content hidden">
                                        <div id="prev-text-3" class="response-textarea"></div>
                                        <button id="prev-copy-btn-3" class="btn btn-secondary btn-sm">📋 Seç ve Kopyala #3</button>
                                    </div>
                                </div>
                                
                                <div id="prev-accordion-4" class="previous-accordion hidden">
                                    <div class="accordion-header" onclick="toggleAccordion('prev-content-4')">
                                        <span class="accordion-title">📄 Yanıt #4</span>
                                        <span class="accordion-icon">▼</span>
                                    </div>
                                    <div id="prev-content-4" class="accordion-content hidden">
                                        <div id="prev-text-4" class="response-textarea"></div>
                                        <button id="prev-copy-btn-4" class="btn btn-secondary btn-sm">📋 Seç ve Kopyala #4</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="app.js?v=20250915-18"></script>
</body>
</html>